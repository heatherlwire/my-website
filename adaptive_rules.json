{
  "meta": {
    "version": "2.0.0",
    "lastUpdated": "2025-11-16",
    "author": "Wire LXD Firm",
    "description": "Dynamic Adaptive Routing Rules for C1â€“C3 based on mastery level and missed sub-competencies",
    "namespace": "https://acbl.wirelxdfirm.com/extensions/",
    "conventions": {
      "masteryLevels": [ "Mastery", "Proficient", "Emerging", "Failing" ],
      "missed": "Array of missed sub-competencies (e.g., ['C1b'])",
      "contentPage": "content/{item}-content.html",
      "applyPage": "apply/{item}/{item}-apply.html",
      "tests": "C1-test, C2-test, C3-test",
      "programComplete": "program-complete.html"
    }
  },

  "C1": [
    {
      "if": { "finalized": true },
      "then": [
        { "set": { "completed": true } },
        { "route": { "go": "C2-test" } }
      ]
    },

    {
      "if": { "mastery": "Mastery" },
      "then": [
        { "set": { "completed": true } },
        { "route": { "go": "C2-test" } }
      ]
    },

    {
      "if": { "mastery": "Proficient" },
      "then": [
        {
          "forEach": "missed",
          "do": [
            { "route": { "content": "{item}-content" } },
            { "route": { "apply": "{item}-apply" } }
          ]
        },
        { "route": { "assessment": "C1-test" } }
      ]
    },

    {
      "if": { "masteryIn": [ "Emerging", "Failing" ] },
      "then": [
        {
          "forEach": [ "C1a", "C1b", "C1c" ],
          "do": [
            { "route": { "content": "{item}-content" } },
            { "route": { "apply": "{item}-apply" } }
          ]
        },
        { "route": { "assessment": "C1-test" } }
      ]
    }
  ],

  "C2": [
    {
      "if": { "finalized": true },
      "then": [
        { "set": { "completed": true } },
        { "route": { "go": "C3-test" } }
      ]
    },

    {
      "if": { "mastery": "Mastery" },
      "then": [
        { "set": { "completed": true } },
        { "route": { "go": "C3-test" } }
      ]
    },

    {
      "if": { "mastery": "Proficient" },
      "then": [
        {
          "forEach": "missed",
          "do": [
            { "route": { "content": "{item}-content" } },
            { "route": { "apply": "{item}-apply" } }
          ]
        },
        { "route": { "assessment": "C2-test" } }
      ]
    },

    {
      "if": { "masteryIn": [ "Emerging", "Failing" ] },
      "then": [
        {
          "forEach": [ "C2a", "C2b", "C2c" ],
          "do": [
            { "route": { "content": "{item}-content" } },
            { "route": { "apply": "{item}-apply" } }
          ]
        },
        { "route": { "assessment": "C2-test" } }
      ]
    }
  ],

  "C3": [
    {
      "if": { "finalized": true },
      "then": [
        { "set": { "completed": true } },
        { "route": { "go": "program-complete" } }
      ]
    },

    {
      "if": { "mastery": "Mastery" },
      "then": [
        { "set": { "completed": true } },
        { "route": { "go": "program-complete" } }
      ]
    },

    {
      "if": { "mastery": "Proficient" },
      "then": [
        {
          "forEach": "missed",
          "do": [
            { "route": { "content": "{item}-content" } },
            { "route": { "apply": "{item}-apply" } }
          ]
        },
        { "route": { "assessment": "C3-test" } }
      ]
    },

    {
      "if": { "masteryIn": [ "Emerging", "Failing" ] },
      "then": [
        {
          "forEach": [ "C3a", "C3b", "C3c" ],
          "do": [
            { "route": { "content": "{item}-content" } },
            { "route": { "apply": "{item}-apply" } }
          ]
        },
        { "route": { "assessment": "C3-test" } }
      ]
    }
  ]
}
